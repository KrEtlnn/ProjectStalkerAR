<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
       <meta charset="utf-8" />
       <title>S.T.A.L.K.E.R. AR</title>
        <link rel="stylesheet" href="stylesheets/style.css" />
        <script src="../datasync-js-master/build/cloud-data-sync-api.js" type="text/javascript"></script>
        <script async defer src="https://maps.googleapis.com/maps/api/jskey=AIzaSyDAjciRmFX6y6r1w9NDAdNm-jY-P2tCKOA&callback=initMap"></script>
        <script src="../gmaps.js" type="text/javascript"></script>
    </head>
    <body>
        <ul id="menu">
            <li class="li">1</li>
            <li class="li">2</li>
            <li class="li">3</li>
        </ul>
        <div id="map"></div>
        <script>
            var icon = {
                bandos: '/photos/bandos.png',
                sidor: '/photos/sidor.png',
                me: '/photos/me.png'
            };

            function initMap() {
                var map;
                map = new google.maps.Map(document.getElementById('map'), { center: { lat: 56.784408, lng: 35.956532 }, zoom: 18, zoomControl: false, streetViewControl: false });
                var bandos = new google.maps.Marker({
                    position: { lat: 56.784408, lng: 35.956532 },
                    map: map,
                    label: 'Бандит',
                    title: 'Бандит',
                    icon: icon.bandos,
                });
                var sidor = new google.maps.Marker({
                    position: { lat: 56.785167, lng: 35.958151 },
                    map: map,
                    label: 'Сидрыч',
                    title: 'Сидрыч',
                    icon: icon.sidor,
                });
                var sidorCircle = new google.maps.Circle({
                    strokeColor: '#FF0000',
                    strokeOpacity: 0.8,
                    strokeWeight: 2,
                    fillColor: '#FFF000',
                    fillOpacity: 0.35,
                    map: map,
                    center: sidor.getPosition(),
                    radius: 15
                });

                if (navigator.geolocation) {
                    navigator.geolocation.watchPosition(geolocationSuccess, geolocationFailure, { enableHighAccuracy: true });

                } else {
                    alert('Чёт беда прям. Ты попробуй другой браузер запусти')
                };

                var myMarker = new google.maps.Marker({
                    position: { lat: 1, lng: 1 },
                    label: 'Я',
                    title: 'Я',
                    map: map,
                    icon: icon.me
                });

                function geolocationSuccess(position) {
                    // Преобразуем местоположение в объект LatLng
                    var location = new google.maps.LatLng(position.coords.latitude, position.coords.longitude);

                    // Отображаем эту точку на карте
                    console.log('geolocation success');
                    map.setCenter(location);
                    myMarker.setPosition(location);
                };

                function geolocationFailure(errorCode) {
                    map.setCenter({ lat: 1, lng: 1 });
                    var msg = "";
                    switch (errorCode) {
                        case 1: msg = "Нет разрешения";
                            break;
                        case 2: msg = "Техническая ошибка";
                            break;
                        case 3: msg = "Превышено время ожидания";
                            break;
                        default: msg = "Что то случилось не так";
                    };
                    alert(msg);
                };
            };

        </script>
        <script src="javascripts/script.js"></script>
    </body>
</html>